import"https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js";document.addEventListener("DOMContentLoaded",async function(){const r=async()=>{try{(await(await fetch("/api/check-admin-status")).json()).isAdmin?(console.log("User is admin, redirecting to panel in 5 seconds..."),setTimeout(()=>{window.location.href="/panel"},5e3),e&&clearInterval(e)):(console.log("User is not admin, starting/continuing polling for redirects..."),e||t())}catch(n){console.error("Error checking admin status or user status:",n),e||t()}};let e;const t=()=>{e!==void 0&&clearInterval(e),e=window.setInterval(async()=>{try{const n=decodeURIComponent(document.cookie.match(/user_email=([^;]+)/)?.[1]||"");if(!n){console.log("No user email found in cookie, stopping polling."),clearInterval(e);return}const o=await(await fetch("/api/users?email="+encodeURIComponent(n))).json();o&&o.current_page&&o.current_page!=="wait"&&(console.log(`Redirecting user to: /${o.current_page}`),clearInterval(e),window.location.href="/"+o.current_page)}catch(n){console.error("Error checking user status during polling:",n)}},2e3)};r()});
